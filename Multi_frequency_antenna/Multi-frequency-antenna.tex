\documentclass[../main.tex]{subfiles}

\begin{document}


%
% -----------------------------------------------------------------------------------------------------------------
%


\begin{frame}[t]{Motivation}

\textbf{Motivation}: Growing interest in multi-functional phased array antennas.
\uncover<2->{
\textbf{Examples}:

\begin{itemize}
    \item Dual-function radar communication (DFRC) \cite{wang2018sparse}
    \begin{itemize}
        \item Use common or shared aperture and frequency spectrum between radar, electronic warfare and military communications
    \end{itemize}
    \item Massive MIMO. 5G technology ($600$MHz - $6$GHz and $24$ - $86$ GHz)
    \begin{itemize}
        \item Each cell has multiple antennas communicating with the wireless device, received by multiple antennas in the device, thus multiple bitstreams of data are transmitted in parallel.
    \end{itemize}
    \item Space-based internet system (Starlink)
    \begin{itemize}
        \item Operates in Ku (12–18 GHz) and Ka (26.5 – 40 GHz) bands
        \item Authorisation operation in V-band (37.5-42.0 GHz and 47.2-50.2 GHz) is obtained recently
    \end{itemize}
\end{itemize}
}

\vspace{0.3cm}

\uncover<3->{
\textbf{Main benefits}: 
\begin{itemize}
    \item Required spectrum efficiency due to spectrum congestion problem.
    \item Significant reduction in array area, cost and weight.
\end{itemize}
}

\end{frame}



%
% ----------------------------------------------------------------------------------------------------------------- 
%



% \begin{frame}[t]{Digital phased array architecture}

% \begin{columns}[t]
%     \begin{column}{0.3\textwidth}
%     \textbf{Key features}:
%     \begin{itemize}
%         \item Flexible
%         \item Expensive
%     \end{itemize}        
%     \end{column}
%     \begin{column}{0.7\textwidth}
%         \begin{figure}[H]
%         \begin{adjustbox}{width=0.75\linewidth}
%         \includegraphics{pics/antenna_structure.jpg}
%         \end{adjustbox}
%         \end{figure}
%     \end{column}
% \end{columns}

% \end{frame}



%
% ----------------------------------------------------------------------------------------------------------------- 
%



\begin{frame}[t]{Reconfigurable phased antenna arrays. Power amplifier non-linearity}

\begin{columns}[t]
\begin{column}{0.5\textwidth}
    \textbf{Modern architecture}:
    \begin{figure}[H]
        \begin{adjustbox}{width=1\linewidth}
        \includegraphics{pics/antenna_structure.jpg}
        \end{adjustbox}
    \end{figure}
\end{column}
\begin{column}{0.5\textwidth}
    \only<2->{
    \textbf{Input}: signals $f_1$ and $f_2$

    \textbf{Output}: 
    \begin{itemize}
        \item $f_1, f_2, 2f_1, 2f_2$ and distortion products: $f_2 \pm f_1$, $2f_1 \pm f_2$, $2f_2 \pm f_1$
    \end{itemize}

    \begin{figure}[H]
    \begin{adjustbox}{width=1\linewidth}
    \includegraphics{pics/IMD.jpg}
    \end{adjustbox}
    \end{figure}}
    % \begin{figure}[H]
    % \centering
    % \begin{tikzpicture}
    % % \draw[thin, color=gray!50] (0, 0) -- (2, 0);
    % % \draw[thin, color=gray!50] (0, 0.5) -- (2, 0.5);
    % \draw[thin, -latex'] (0, 0) -- node[above]{$f_1$} (2, 0);
    % \draw[thin, -latex'] (0, 0.5) -- node[above]{$f_2$} (2, 0.5);
    % \end{tikzpicture}
    % \end{figure}
\end{column}
\end{columns}

\end{frame}


%
% -----------------------------------------------------------------------------------------------------------------
%

\begin{frame}[t]{Multi-frequency antenna elements allocation}

\begin{columns}[t]

\begin{column}{0.6\textwidth}
    \begin{figure}[H]
  \centering
  \begin{tikzpicture}
    \draw[thin, color=gray!50] (0, 0) -- (0, 0.5);
    \draw[thin, color=gray!50] (1, 0) -- (1, 0.5);
    \draw[thin, latex'-latex'] (0, 0.5) -- node[above]{$d$} (1, 0.5);

    \draw[thin, -latex', color=gray] (0, 0) -- (-1, 1);
    \coordinate (a1) at (-1, 0);
    \coordinate (b1) at (0, 0);
    \coordinate (c1) at (-1, 1);
    \pic["$\phi_{m}$", draw,<-,>=stealth,angle eccentricity=1.7, angle radius=0.5cm] {angle=c1--b1--a1};
    \draw[thin] (a1) -- (b1);
    \draw[fill] (0,0) circle [radius=0.1] node[below left]{\scriptsize $1$};
    \draw[thin, -latex'] (0, -1) node[below]{$I^{\lambda_k}_1$} -- (0, -0.1);

    \draw[fill] (1,0) circle [radius=0.1] node[below left]{\scriptsize $2$};
    \draw[thin, -latex'] (1, -1) node[below]{$I^{\lambda_k}_2$} -- (1, -0.1);

    \draw[thin, -latex', color=gray] (2, 0) -- (1, 1);
    \draw[fill] (2,0) circle [radius=0.1] node[below left]{\scriptsize $3$};
    \draw[thin, -latex'] (2, -1) node[below]{$I^{\lambda_k}_3$} -- (2, -0.1);

    \draw[draw=black, dotted] (-0.4, -1) rectangle node[below=0.5cm]{$I^{\lambda_k}$} (2.4, -1.7);

    \draw[thin, -latex', color=gray] (3, 0) -- (2, 1);
    \draw[fill] (3,0) circle [radius=0.1] node[below left]{\scriptsize $4$};
    \draw[thin, -latex'] (3, -1) node[below]{$I^{\lambda_{l}}_1$} -- (3, -0.1);

    \draw[dotted, thin](3.5, 0) -- (4.5, 0);

    \draw[thin, -latex', color=gray] (5, 0) -- (4, 1);
    \draw[fill] (5,0) circle [radius=0.1] node[below left]{\scriptsize $N-1$};
    \draw[thin, thin, -latex'] (5, -1) node[below]{$I^{\lambda_{l}}_n$} -- (5, -0.1);
    
    \draw[thin, -latex', color=gray] (6, 0) -- (5, 1);
    \draw[fill] (6,0) circle [radius=0.1] node[below left]{\scriptsize $N$};
    \draw[thin, thin, -latex'] (6, -1) node[below]{$I^{\lambda_{l}}_{n+1}$} -- (6, -0.1);

    \draw[draw=black, dotted] (2.6, -1) rectangle node[below=0.5cm]{$I^{\lambda_l}$} (6.4, -1.7);

  \end{tikzpicture}
\end{figure}

\begin{itemize}
    \item $I^{\lambda_{l}}$ and $I^{\lambda_{k}}$  are randomly allocated currents with wavelengths $\lambda_l$ and $\lambda_k$ for illustration purposes
    \item $\phi_{m}$ is the beam angle, $d$ is the distance between antenna elements
\end{itemize}

\end{column}
\begin{column}{0.4\textwidth}
    \textbf{Assumption}:
    Antenna elements are effective radiators in the band of interest (broadband radiators), e.g Vivaldi antennas:

    \begin{figure}[H]
    \begin{adjustbox}{width=0.65\linewidth}
    \includegraphics{pics/vivaldi-print.jpg}
    \end{adjustbox}
    \end{figure}

    \textbf{Note}:
    We aim to allocate one frequency per element
\end{column}
    
\end{columns}

\end{frame}


%
% -----------------------------------------------------------------------------------------------------------------
%

\begin{frame}[t]{Problem formulation}

\textbf{Given:} antenna configuration ($d, N$), reference patterns at different frequencies.

\textbf{Find:} optimal allocation of currents $I^{\lambda_{1\ldots k}}$ among antenna elements
    
\begin{equation*}
\begin{aligned}
& \minimise_{I^{\lambda_{1\ldots k}}} 
& & \Big\| \mathcal{F}^{\lambda_{1 \ldots k}} I^{\lambda_{1\ldots k}} - b^{\lambda_{1 \ldots k}} \Big\|_2^2 \\
& \st
& & I^{\lambda_i} \odot I^{\lambda_j} = 0, \quad \forall i, j \colon i \ne j \\
\end{aligned}
\end{equation*}

where $b^{\lambda_{k}}_m$ is the amplitude of a reference beam with wavelength $\lambda_{k}$ in direction $m$ and
\begin{equation*}
  \mathcal{F}_{\lambda_{1 \ldots k}} = \diag{(\mathcal{F}_{\lambda_1}, \mathcal{F}_{\lambda_2}, \ldots, \mathcal{F}_{\lambda_k})}, \quad \mathcal{F}_{\lambda_{k}} = \Big\{ e^{i \frac{2\pi}{\lambda_k}n d \cos{\phi_m}} \Big\}_{n=0\ldots N, m = 0\ldots M}
\end{equation*}

\textbf{Note}: 
\begin{itemize}
    \item The problem is non-convex, non-linear with a combinatorial constraint, i.e. $k^N$ solutions should be tested ($k$ - number of frequencies, $N$ - number of elements) if unconstrained problem is optimally solvable.
\end{itemize}

\end{frame}


%
% -----------------------------------------------------------------------------------------------------------------
%



\begin{frame}[t]{Objective function choice}

\begin{columns}[t]
\begin{column}{0.5\textwidth}
    Fourier Transform pattern:
    \begin{equation*}
    \minimise_{I^{\lambda_{1\ldots k}}} \Big\| \mathcal{F}^{\lambda_{1 \ldots k}} I^{\lambda_{1\ldots k}} - b^{\lambda_{1 \ldots k}} \Big\|_2^2
    \end{equation*}

    % \begin{equation*}
    % \begin{aligned}
    % & \minimise_{I^{\lambda_{1\ldots k}}} 
    % & & \Big\| \mathcal{F}^{\lambda_{1 \ldots k}} I^{\lambda_{1\ldots k}} - b^{\lambda_{1 \ldots k}} \Big\|_2^2 \\
    % & \st
    % & & (I^{\lambda_{1\ldots k}})^T B I^{\lambda_{1\ldots k}} = 0 \\
    % &&& I^{\lambda_{1\ldots k}} \succeq 0 \\
    % \end{aligned}
    % \end{equation*}

\end{column}
\begin{column}{0.5\textwidth}
    Power pattern:
    \begin{equation*}
    \minimise_{I^{\lambda_{1\ldots k}}}  \Big\| |\mathcal{F}^{\lambda_{1 \ldots k}} I^{\lambda_{1\ldots k}}|^2 - b^{\lambda_{1 \ldots k}} \Big\|_2^2
    \end{equation*}
\end{column}
\end{columns}

\begin{equation*}
\begin{aligned}
& \st
& & (I^{\lambda_{1\ldots k}})^T B I^{\lambda_{1\ldots k}} = 0, \quad \text{\textcolor{gray}{($B=\begin{bmatrix} 0 & I \\ I & 0\end{bmatrix}$ for $2$ different currents)}} \\
&&& I^{\lambda_{1\ldots k}} \succeq 0 \\
\end{aligned}
\end{equation*}

% For $2$ different currents: $B = \begin{bmatrix} 0 & I \\ I & 0\end{bmatrix}$.
\begin{columns}[t]
\begin{column}{0.5\textwidth}
    \textbf{Features}:
    \begin{itemize}
        \item Non-trivial lower bound can be obtained:
            \begin{equation*}
            \begin{split}
            \min_{x \ge 0} \Big\{ &\| \mathcal{F}^{\lambda_{1 \ldots k}}x - b^{\lambda_{1 \ldots k}} \|_2^2 + \\ 
            & \lambda_{min} (\overline{\mathcal{F}^{\lambda_{1 \ldots k}}}\mathcal{F}^{\lambda_{1 \ldots k}}) x^T B x \Big\} \\
            \end{split}
            \end{equation*}
    \end{itemize}
    
\end{column}
\begin{column}{0.5\textwidth}
    \textbf{Features}:
    \begin{itemize}
        \item Non-convex objective
        \item Exploiting phases (expect better results)
        \item Unconstrained problem optimality condition leads to \textbf{uncertainty principle} 
    \end{itemize}
\end{column}    
\end{columns}


\end{frame}





%
% -----------------------------------------------------------------------------------------------------------------
%

\begin{frame}[t]{Power pattern. Uncertainty principle}

\begin{equation*}
\Big\| |\mathcal{F}^{\lambda_{1 \ldots k}} I^{\lambda_{1\ldots k}}|^2 - b^{\lambda_{1 \ldots k}} \Big\|_2^2 = \sum_{k=1}^K \sum_{m=1}^M \Big\| (I^{\lambda_{k}})^T Q^{\lambda_{k}}_m  I^{\lambda_{k}} - b^{\lambda_{k}}_m \Big\|_2^2
\end{equation*}


 
\begin{itemize}
	\item It can be shown that the gradient of the objective function is non-zero everywhere except the solution if $\mathcal{N}_{+}(Q^{\lambda_{k}}_m) = \varnothing, ~\forall i$, $Q^{\lambda_{k}}_m = \Real{(f_m^{\lambda_{k}} \overline{f_m^{\lambda_{k}}})}$ \cite{iakovlev2019multi}
	\item Analysis of $\mathcal{N}_{+}(Q_i)$ leads to the following conditions:
	\begin{equation*}
  \frac{d}{\lambda} \neq \frac{k}{N+1} \sec \phi_m , \quad \frac{d}{\lambda} \neq \frac{1}{2N} (1 + 2k) \sec \phi_m, \quad \forall m \in \mathbb{Z}^{\ge 0}, \forall k \in \mathbb{Z}
  \label{antenna_design_condition}
	\end{equation*}
	\item These conditions can be interpreted as an \textbf{uncertainty principle} for antenna design \cite{iakovlev2019multi}: 
\end{itemize}

\begin{center}
\begin{tcolorbox}
\textit{The finer the spacial resolution of the beam is the more values of $\frac{d}{\lambda}$ should be avoided in favour of optimality, i.e. $\mathcal{N}_{+}(Q_i) = \varnothing$.}
\end{tcolorbox}
\end{center}

\end{frame}



\begin{frame}[t]{Practical solution}

\begin{itemize}
\item Introduce $J^{\lambda_k}_n = \log{I^{\lambda_k}_n}$ (this implies $I^{\lambda_k}_n > 0$)
\item Combinatorial constraints are converted into linear constraints:
    \begin{equation*}
  I^{\lambda_i} \odot I^{\lambda_j} = 0 \quad \rightarrow \quad J^{\lambda_i} + J^{\lambda_j} \le -\epsilon, \quad \forall i, j \colon i \ne j
    \end{equation*}
    where $\epsilon$ is a design parameter. 
\end{itemize}

Optimisation problem:
\begin{equation*}
\begin{aligned}
& \minimise_{J^{\lambda_{1\ldots k}}} 
& & \sum_{k=1}^K \sum_{m=1}^M \Big\| (e^{J^{\lambda_{k}}})^T Q^{\lambda_{k}}_m  e^{J^{\lambda_{k}}} - b^{\lambda_{k}}_m \Big\|_2^2 \\
& \st
& & J^{\lambda_i} + J^{\lambda_j} \le -\epsilon, \quad \forall i, j \colon i \ne j \\
\end{aligned}
\label{general_problem_formulation3}
\end{equation*}

\end{frame}



\begin{frame}[t]{Algorithm}

\begin{equation*}
\begin{aligned}
& \minimise_{J^{\lambda_{1\ldots k}}} 
& & \sum_{k=1}^K \sum_{m=1}^M \Big\| (e^{J^{\lambda_{k}}})^T Q^{\lambda_{k}}_m  e^{J^{\lambda_{k}}} - b^{\lambda_{k}}_m \Big\|_2^2 \\
& \st
& & M J^{\lambda_{1 \ldots k}} \le - \epsilon
\end{aligned}
\label{general_problem_formulation3}
\end{equation*}

\begin{enumerate}[\color{black}(1)]
    \item Solve unconstrained problem, get $J^*$
    \item Choose $\epsilon = \min{|MJ^*|}$. Increase by $\delta \epsilon$.
    \item Solve constrained problem. Return to the previous step
\end{enumerate}

\vspace{0.3cm}

\textbf{Note}. The following does not change key properties:
\begin{itemize}
    \item Mutual coupling matrix can be incoropated in $Q^{\lambda_{k}}_m$
    \item Phase shifts can be incorporated in $Q^{\lambda_{k}}_m$
\end{itemize}

\end{frame}



\begin{frame}[t]{Results}
\begin{columns}[t]
\begin{column}{0.5\textwidth}
    \centering
    \textbf{Allocation of two frequencies}
    \begin{figure}[H]
    \centering
    \begin{adjustbox}{width=0.8\linewidth}
    \input{pics/10conf_2freq.tex}
    \end{adjustbox}
    \end{figure}  
\end{column}
\begin{column}{0.5\textwidth}
    \centering
    \textbf{Allocation of three frequencies}
    \begin{figure}[H]
    \centering
    \begin{adjustbox}{width=0.8\linewidth}
    \input{pics/10conf_3freq.tex}
    \end{adjustbox}
    \end{figure}  
\end{column}    
\end{columns}

\vspace{0.3cm}

\textbf{Experimental setup}:
\begin{itemize}
    \item 10 different antenna configurations are shown (averaged)
    \item Number of elements varied from $10$ to $60$
\end{itemize}

\end{frame}



\begin{frame}[t]{Results. Allocation of three frequencies}

\textbf{Note}:
\begin{itemize}
    \item $50$ elements, $d$ - distance between elements
    \item All units are normalised
\end{itemize}

\begin{columns}[b]
        \begin{column}{0.55\textwidth}
            \centering
            \begin{adjustbox}{width=1\columnwidth}
            \input{pics/formed_beams.tex}
            \end{adjustbox}
        \end{column}
        \begin{column}{0.55\textwidth}
            \centering
            \begin{adjustbox}{width=1\columnwidth}
            \input{pics/current_distribution.tex}
            \end{adjustbox}
        \end{column}
\end{columns}   

\end{frame}


%
% -----------------------------------------------------------------------------------------------------------------
%



\end{document}

